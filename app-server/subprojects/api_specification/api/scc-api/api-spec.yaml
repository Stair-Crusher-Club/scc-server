openapi: '3.0.0'
info:
  title: Stair Crusher Club API Specification
  version: '1.0.0'
  description: |
    ## 계단정복지도 서비스의 서버 - 클라이언트 통신을 위한 API 명세.

defaultContentType: application/json

servers:
  - url: https://{env}.staircrusher.club/
    variables:
      env:
        description: API 주소 환경 설정
        default: 'api'
        enum:
          - 'api'
          - 'api.dev'

security:
  # 모든 API 는 기본적으로 AnonymousUserAuth 를 적용
  - Anonymous: []

paths:
  /cancelBuildingAccessibilityUpvote:
    post:
      security:
        - Identified: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CancelBuildingAccessibilityUpvoteRequestDto'
        required: true
      responses:
        '204': { }
      summary: '''이 정보가 도움이 돼요''를 취소한다.'

  /cancelPlaceAccessibilityUpvote:
    post:
      security:
        - Identified: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CancelPlaceAccessibilityUpvoteRequestDto'
        required: true
      responses:
        '204': { }
      summary: '''이 정보가 도움이 돼요''를 취소한다.'

  /createAnonymousUser:
    post:
      summary: 비회원 계정을 생성한다.
      security: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateAnonymousUserResponseDto'

  /createPlaceFavorite:
    post:
      summary: 장소를 즐겨찾기에 추가한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePlaceFavoriteRequestDto'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePlaceFavoriteResponseDto'

  /deleteAccessibility:
    post:
      summary: |
        등록한 접근성 정보를 삭제한다.
        기본적으로는 장소 정보만 삭제하지만, 삭제하는 장소 정보가 해당 건물의 마지막 장소 정보일 경우 건물 정보도 함께 삭제한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                placeAccessibilityId:
                  type: string
                  description: 삭제할 장소 정보의 아이디
              required:
                - placeAccessibilityId
      responses:
        '204': { }
        '400':
          $ref: '#/components/responses/ApiFailure'

  /deletePlaceFavorite:
    post:
      summary: 장소를 즐겨찾기에서 삭제한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeletePlaceFavoriteRequestDto'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeletePlaceFavoriteResponseDto'

  /deleteUser:
    post:
      summary: 계정을 삭제한다.
      security:
        - Identified: []
      responses:
        '204': { }

  /getAccessibility:
    post:
      summary: 건물 & 점포의 접근성 정보를 조회한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                placeId:
                  type: string
              required:
                - placeId
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccessibilityInfoDto'

  /getPlaceWithBuilding:
    post:
      summary: 건물 & 점포 정보를 조회한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                placeId:
                  type: string
              required:
                - placeId
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlaceListItem'

  /getAccessibilityLeaderboard:
    post:
      summary: 현재 탑 랭커들을 조회한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties: { }
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  ranks:
                    type: array
                    items:
                      $ref: '#/components/schemas/AccessibilityRankDto'
                required:
                  - ranks

  /getAccessibilityRank:
    post:
      summary: 내 현재 랭크를 조회한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties: { }
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessibilityRank:
                    $ref: '#/components/schemas/AccessibilityRankDto'
                required:
                  - accessibilityRank

  /getCountForNextRank:
    post:
      security:
        - Identified: []
      requestBody:
        content:
          application/json:
            schema:
              properties: { }
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  countForNextRank:
                    type: integer
                required:
                  - countForNextRank
                type: object
      summary: 다음 랭크로 올라가기 위한 점수를 조회한다.

  /getImageUploadUrls:
    post:
      summary: 점포 정보 등록 등의 상황에서 이미지를 업로드하기 위한 URL을 받아 온다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                count:
                  type: integer
                  description: 업로드할 이미지 수.
                filenameExtension:
                  type: string
                  description: 업로드할 이미지의 확장자. '.'을 붙이지 말아야 한다. e.g. png, jpeg 등.
              required:
                - count
                - filenameExtension
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    url:
                      type: string
                    expireAt:
                      $ref: '#/components/schemas/EpochMillisTimestamp'
                      description: url의 만료 시각.
                  required:
                    - url
                    - expireAt
  /getChallenge:
    post:
      summary: 챌린지 리스트에서 공개된 챌린지를 선택해서 챌린지를 조회한다.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetChallengeRequestDto'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetChallengeResponseDto'

  /getChallengeWithInvitationCode:
    post:
      summary: 공개되지 않은 챌린지를 초대코드를 통해 챌린지를 조회한다.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetChallengeWithInvitationCodeRequestDto'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetChallengeResponseDto'

  /getClientVersionStatus:
    post:
      summary: 앱 버전에 따라 업데이트 상태를 알려준다
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetClientVersionStatusRequestDto'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetClientVersionStatusResponseDto'

  /getAccessibilityActivityReport:
    post:
      summary: 유저 접근성 정보 정복 활동을 조회한다
      security:
        - Identified: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetAccessibilityActivityReportResponseDto'

  /getUserInfo:
    get:
      summary: 유저 정보를 조회한다.
      security:
        - Identified: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetUserInfoResponseDto'

  /giveBuildingAccessibilityUpvote:
    post:
      summary: "'이 정보가 도움이 돼요'를 준다."
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GiveBuildingAccessibilityUpvoteRequestDto'
      responses:
        '204': { }

  /givePlaceAccessibilityUpvote:
    post:
      summary: "'이 정보가 도움이 돼요'를 준다."
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GivePlaceAccessibilityUpvoteRequestDto'
      responses:
        '204': { }

  /joinChallenge:
    post:
      summary: 챌린지에 참여한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JoinChallengeRequestDto'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JoinChallengeResponseDto'

  /listAdministrativeAreas:
    post:
      summary: 점포를 검색한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties: { }
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  eupMyeonDongs:
                    items:
                      $ref: '#/components/schemas/EupMyeonDong'
                    type: array
                  siGunGus:
                    items:
                      $ref: '#/components/schemas/SiGunGu'
                    type: array
                type: object

  /listChallenges:
    post:
      summary: 공개된 챌린지 리스트를 조회한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListChallengesRequestDto'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListChallengesResponseDto'

  /listConqueredPlaces:
    post:
      summary: 내가 정복한 장소 목록을 조회한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListConqueredPlacesRequestDto'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListConqueredPlacesResponseDto'

  /listPlacesInBuilding:
    post:
      summary: 특정 건물의 점포를 조회한다.
      description: "'이 건물에 다른 점포 등록하기'를 눌렀을 때 호출된다."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                buildingId:
                  type: string
              required:
                - buildingId
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/PlaceListItem'
                required:
                  - items

  /listSearchKeywordsOfPlaceCategory:
    post:
      summary: 특정 카테고리의 점포들을 검색할 수 있게 키워드들을 내려준다.
      description: "음식점, 카페, 편의점, 병원 같이 키워드를 내려주면 searchPlaces 키워드로 쓸 수 있습니다."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties: { }
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  items:
                    items:
                      $ref: '#/components/schemas/SearchKeywordOfPlaceCategoryDto'
                    type: array
                required:
                  - items
                type: object

  /login:
    post:
      summary: 로그인을 한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                password:
                  type: string
              required:
                - nickname
                - password
      responses:
        '204':
          description: |
            빈 response body를 내려준다.
            대신 Header의 X-SCC-ACCESS-KEY에 access token을 내려준다. (회원가입하면 자동 로그인)
            클라이언트는 이 토큰을 Bearer auth의 토큰으로 사용하면 된다.

  /loginWithApple:
    post:
      summary: 애플 로그인을 통해 로그인 or 회원가입을 한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginWithAppleRequestDto'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResultDto'
        '400':
          $ref: '#/components/responses/ApiFailure'
          description: |-
            에러 코드 설명
            - INVALID_AUTHENTICATION : 클라이언트에서 올려준 토큰 중 일부가 잘못된 경우.

  /loginWithKakao:
    post:
      summary: 카카오 로그인을 통해 로그인 or 회원가입을 한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                kakaoTokens:
                  $ref: '#/components/schemas/KakaoTokensDto'
              required:
                - kakaoTokens
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResultDto'
        '400':
          $ref: '#/components/responses/ApiFailure'
          description: |-
            에러 코드 설명
            - INVALID_AUTHENTICATION : kakaoTokens 중 일부가 잘못된 경우.

  /registerBuildingAccessibility:
    post:
      summary: 건물 접근성 정보를 등록한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterBuildingAccessibilityRequestDto'
      responses:
        '204':
          description: |
            장소 id를 알 수 없으므로 GetAccessibilityInfo를 내려줄 수 없다.
            따라서 건물 장소 등록 이후에 명시적으로 /getAccessibility API를 별도로 호출하도록 한다.

  /registerBuildingAccessibilityComment:
    post:
      summary: 건물에 의견을 추가한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                buildingId:
                  type: string
                comment:
                  type: string
              required:
                - buildingId
                - comment
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  buildingAccessibilityComment:
                    $ref: '#/components/schemas/BuildingAccessibilityComment'
                    description: 방금 등록된 댓글.
                required:
                  - buildingAccessibilityComment

  /registerPlaceAccessibility:
    post:
      summary: 점포의 접근성 정보를 등록한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterPlaceAccessibilityRequestDto'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterPlaceAccessibilityResponseDto'

  /registerPlaceAccessibilityComment:
    post:
      summary: 점포에 의견을 추가한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                placeId:
                  type: string
                comment:
                  type: string
              required:
                - placeId
                - comment
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  placeAccessibilityComment:
                    $ref: '#/components/schemas/PlaceAccessibilityComment'
                    description: 방금 등록된 댓글.
                required:
                  - placeAccessibilityComment

  /reportAccessibility:
    post:
      summary: 등록된 접근성 정보가 올바르지 않은 경우 신고한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                placeId:
                  type: string
                  description: 신고할 장소의 아이디
                reason:
                  type: string
                  description: 신고 사유
              required:
                - placeId
      responses:
        '204': { }

  /searchExternalAccessibilities:
    post:
      summary: 외부 접근성 정보가 등록된 장소를 검색한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                searchText:
                  type: string
                currentLocation:
                  $ref: '#/components/schemas/Location'
                distanceMetersLimit:
                  type: integer
                categories:
                  type: array
                  description: 조회하고 싶은 접근성 정보 카테고리. 현재 화장실 (TOILET) 만 있음.
                  items:
                    type: string
              required:
                - distanceMetersLimit
      responses:
        '200':
          description: 응답 리스트
          content:
            application/json:
              schema:
                properties:
                  items:
                    items:
                      $ref: '#/components/schemas/ExternalAccessibility'
                    type: array
                type: object

  /getExternalAccessibility:
    post:
      summary: 공공 접근성 정보를 확인한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                externalAccessibilityId:
                  type: string
              required:
                - externalAccessibilityId
      responses:
        '200':
          description: 해당 접근성 정보를 응답으로 내려준다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExternalAccessibility'


  /searchPlaces:
    post:
      summary: 점포를 검색한다. sort 가 null 인 경우에는 정확도순을 기본으로 한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                searchText:
                  type: string
                currentLocation:
                  $ref: '#/components/schemas/Location'
                distanceMetersLimit:
                  type: integer
                siGunGuId:
                  type: string
                eupMyeonDongId:
                  type: string
                sort:
                  $ref: '#/components/schemas/SearchPlaceSortDto'
                filters:
                  $ref: '#/components/schemas/SearchPlaceFilterDto'
              required:
                - searchText
                - distanceMetersLimit
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  items:
                    items:
                      $ref: '#/components/schemas/PlaceListItem'
                    type: array
                type: object
  /signUp:
    post:
      summary: 회원가입을 한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                password:
                  type: string
                instagram_id:
                  type: string
              required:
                - nickname
                - password
      responses:
        '204':
          description: |
            빈 response body를 내려준다.
            대신 Header의 X-SCC-ACCESS-KEY에 access token을 내려준다. (회원가입하면 자동 로그인)
            클라이언트는 이 토큰을 Bearer auth의 토큰으로 사용하면 된다.

  /updateUserInfo:
    post:
      summary: 유저 정보를 수정한다.
      security:
        - Identified: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                instagramId:
                  type: string
                  description: 변경되지 않았으면 기존 값을 그대로 올려준다.
                email:
                  type: string
                birthYear:
                  type: integer
                mobilityTools:
                  type: array
                  items:
                    $ref: '#/components/schemas/UserMobilityToolDto'
                isNewsLetterSubscriptionAgreed:
                  type: boolean
              required:
                - nickname
                - email
                - mobilityTools
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  user:
                    $ref: '#/components/schemas/User'
                required:
                  - user
                type: object
        '400':
          $ref: '#/components/responses/ApiFailure'
          description: |-
            에러 코드 설명
            - INVALID_NICKNAME : 닉네임이 유효하지 않을 때. e.g. 중복, 2글자 미만 등.
            - INVALID_EMAIL : 이메일이 유효하지 않을 때. e.g. 중복, 이상한 형태 등.
            - INVALID_BIRTH_YEAR : 출생 연도가 유효하지 않을 때. e.g. 1900년 이전, 2025년 이후 등.
  /updatePushToken:
    post:
      summary: 유저의 push token 정보를 수정한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                pushToken:
                  type: string
              required:
                - pushToken
      responses:
        '200': {}

  /getHomeBanners:
    post:
      summary: 홈에서 보여줄 배너 정보 목록을 가져온다.
      operationId: getHomeBanners
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetHomeBannersResponseDto'

  /validateUserProfile:
    post:
      summary: 유저 프로필 정보의 유효성을 검사한다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                  description: 유효성을 검사할 닉네임. null인 경우 유효한 것으로 간주
                email:
                  type: string
                  description: 유효성을 검사할 이메일. null인 경우 유효한 것으로 간주
              required: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  nicknameErrorMessage:
                    type: string
                    description: 닉네임이 유효하지 않은 경우 에러 메시지, 유효하거나 null인 경우 null
                  emailErrorMessage:
                    type: string
                    description: 이메일이 유효하지 않은 경우 에러 메시지, 유효하거나 null인 경우 null
                required: []
        '400':
          $ref: '#/components/responses/ApiFailure'

components:
  # Security schemes
  securitySchemes:
    Anonymous:
      type: http
      scheme: bearer

    Identified:
      type: http
      scheme: bearer

  # Reusable schemas (data models)
  schemas:
    AccessibilityInfoDto:
      type: object
      properties:
        buildingAccessibility:
          $ref: '#/components/schemas/BuildingAccessibility'
          description: 정보가 아직 채워지지 않았으면 null.
        buildingAccessibilityComments:
          type: array
          items:
            $ref: '#/components/schemas/BuildingAccessibilityComment'
          description: 정보가 아직 채워지지 않았으면 empty list.
        placeAccessibility:
          $ref: '#/components/schemas/PlaceAccessibility'
          description: 정보가 아직 채워지지 않았으면 null.
        placeAccessibilityComments:
          type: array
          items:
            $ref: '#/components/schemas/PlaceAccessibilityComment'
          description: 정보가 아직 채워지지 않았으면 empty list.
        hasOtherPlacesToRegisterInBuilding:
          type: boolean
          description: "'이 건물의 다른 점포 등록하기'를 보여줄지 여부."
        isFavoritePlace:
          type: boolean
          description: 내가 즐겨찾기한 장소인지 여부.
        totalFavoriteCount:
          type: integer
          format: int64
          description: 이 장소를 즐겨찾기한 사람 수.
      required:
        - buildingAccessibilityComments
        - placeAccessibilityComments
        - hasOtherPlacesToRegisterInBuilding
        - isFavoritePlace
        - totalFavoriteCount

    AccessibilityRankDto:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/AccessibilityRegistererDto'
        conqueredCount:
          type: integer
          description: 접근성 정보를 등록한 장소의 수.
        rank:
          type: integer
          format: int64
          description: 현재 나의 랭크. 1부터 시작.
      required:
        - user
        - conqueredCount
        - rank

    AccessibilityRegistererDto:
      type: object
      properties:
        id:
          type: string
        nickname:
          type: string
        instagramId:
          type: string
      required:
        - id
        - nickname

    ApiErrorResponse:
      type: object
      properties:
        msg:
          type: string
          description: reason for error
        code:
          type: string # Do not change to integer. Jackson's @JsonProperty does not support number serialization.
          x-enum-varnames:
            - INTERNAL_FAILURE # -999999
            - INVALID_AUTHENTICATION # 1
            - INVALID_NICKNAME # 2
            - INVALID_EMAIL # 3
            - INVALID_ARGUMENTS # 4
            - INVALID_PASSCODE # 10
            - ALREADY_JOINED # 11
            - CHALLENGE_NOT_OPENED # 12
            - CHALLENGE_CLOSED # 13
            - INVALID_BIRTH_YEAR # 14

          enum:
            - -999999
            - 1
            - 2
            - 3
            - 4
            - 10 # Challenge
            - 11
            - 12
            - 13
            - 14

    AuthTokensDto:
      type: object
      properties:
        accessToken:
          type: string
      required:
        - accessToken

    Building:
      description: 건물 정보.
      properties:
        id:
          type: string
        address:
          type: string
          description: 건물의 human-readable한 주소.
        location:
          $ref: '#/components/schemas/Location'
          description: 건물의 위경도.
      required:
        - id
        - address

    BuildingAccessibility:
      description: 건물의 접근성 정보.
      properties:
        id:
          type: string
        entranceStairInfo:
          $ref: '#/components/schemas/StairInfo'
        entranceStairHeightLevel:
          $ref: '#/components/schemas/StairHeightLevel'
        entranceImageUrls:
          deprecated: true
          type: array
          items:
            type: string
        entranceImages:
          type: array
          items:
            $ref: '#/components/schemas/ImageDto'
        entranceDoorTypes:
          type: array
          items:
            $ref: '#/components/schemas/EntranceDoorType'
        hasSlope:
          type: boolean
        hasElevator:
          type: boolean
        elevatorStairInfo:
          $ref: '#/components/schemas/StairInfo'
        elevatorStairHeightLevel:
          $ref: '#/components/schemas/StairHeightLevel'
        elevatorImageUrls:
          deprecated: true
          type: array
          items:
            type: string
        elevatorImages:
          type: array
          items:
            $ref: '#/components/schemas/ImageDto'
        buildingId:
          type: string
        registeredUserName:
          type: string
          description: 익명으로 등록되었으면 null.
        challengeCrusherGroup:
          $ref: '#/components/schemas/ChallengeCrusherGroupDto'
        isUpvoted:
          type: boolean
          description: 유저가 이 접근성 정보에 '도움이 돼요'를 표시했는지 여부.
        totalUpvoteCount:
          type: integer
          description: 이 접근성 정보가 '도움이 돼요'를 받은 총 횟수. 이 숫자에 따라 버튼 텍스트에 '도움이 돼요'나 '정확한 정보에요'를 사용한다.
        createdAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
      required:
        - id
        - entranceStairInfo
        - entranceImageUrls
        - hasSlope
        - hasElevator
        - elevatorStairInfo
        - elevatorImageUrls
        - buildingId
        - isUpvoted
        - totalUpvoteCount
        - createdAt

    BuildingAccessibilityComment:
      description: 건물에 대한 의견.
      properties:
        id:
          type: string
        buildingId:
          type: string
        user:
          $ref: '#/components/schemas/AccessibilityRegistererDto'
          description: 익명으로 달린 댓글이면 null.
        comment:
          type: string
        createdAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
      required:
        - id
        - buildingId
        - comment
        - createdAt

    CancelBuildingAccessibilityUpvoteRequestDto:
      properties:
        buildingAccessibilityId:
          type: string
      required:
        - buildingAccessibilityId
      type: object

    CancelPlaceAccessibilityUpvoteRequestDto:
      properties:
        placeAccessibilityId:
          type: string
      required:
        - placeAccessibilityId
      type: object

    ChallengeDto:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        status:
          $ref: '#/components/schemas/ChallengeStatusDto'
        isPublic:
          type: boolean
        isComplete:
          type: boolean
        startsAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
        endsAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
        goal:
          type: integer
          format: int32
        milestones:
          type: array
          items:
            type: integer
            format: int32
        participationsCount:
          type: integer
          format: int32
        contributionsCount:
          type: integer
          format: int32
        description:
          type: string
        crusherGroup:
          $ref: '#/components/schemas/ChallengeCrusherGroupDto'
      required:
        - id
        - name
        - status
        - isPublic
        - isComplete
        - startsAt
        - goal
        - milestones
        - participationsCount
        - contributionsCount
        - description

    ChallengeRankDto:
      type: object
      properties:
        rank:
          type: integer
          format: int64
          description: 현재 랭크. 1부터 시작.
        contributionCount:
          type: integer
          format: int64
          description: 챌린지 안에서 이룬 성과. ex) 365 개 정복
        nickname:
          type: string
          description: 성과를 이룬 유저 이름.
      required:
        - rank
        - contributionCount
        - nickname

    ChallengeStatusDto:
      type: string
      enum:
        - InProgress # 진행중
        - Upcoming # 오픈 예정
        - Closed # 종료된 챌린지

    ChallengeCrusherGroupDto:
      type: object
      properties:
        icon:
          $ref: '#/components/schemas/ImageDto'
        name:
          type: string
      required:
        - name

    CreateAnonymousUserResponseDto:
      type: object
      properties:
        authTokens:
          $ref: '#/components/schemas/AuthTokensDto'
      required:
        - authTokens

    CreatePlaceFavoriteRequestDto:
      type: object
      properties:
        placeId:
          type: string
      required:
        - placeId

    CreatePlaceFavoriteResponseDto:
      type: object
      properties:
        totalPlaceFavoriteCount:
          type: integer
          format: int64
        placeFavorite:
          $ref: '#/components/schemas/PlaceFavorite'
      required:
        - totalPlaceFavoriteCount
        - placeFavorite

    DeletePlaceFavoriteRequestDto:
      type: object
      properties:
        placeId:
          type: string
      required:
        - placeId

    DeletePlaceFavoriteResponseDto:
      type: object
      properties:
        totalPlaceFavoriteCount:
          type: integer
          format: int64
      required:
        - totalPlaceFavoriteCount

    EntranceDoorType:
      type: string
      enum:
        - None
        - Hinged
        - Sliding
        - Revolving
        - Automatic
        - ETC

    EupMyeonDong:
      description: 읍면동을 표현하기 위한 모델.
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        siGunGuId:
          type: string
      required:
        - id
        - name
        - siGunGuId

    EpochMillisTimestamp:
      description: 특정 시각을 표현하기 위한 모델.
      type: object
      properties:
        value:
          type: integer
          format: int64
      required:
        - value

    PlaceFavorite:
      type: object
      properties:
        userId:
          type: string
        placeId:
          type: string
        createdAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
      required:
        - userId
        - placeId

    GetAccessibilityActivityReportResponseDto:
      type: object
      properties:
        todayConqueredCount:
          description: 오늘 정복한 장소/건물 수
          type: integer
          format: int32
        thisMonthConqueredCount:
          description: 이번달 정복한 장소/건물 수
          type: integer
          format: int32
        thisWeekConqueredWeekdays:
          description: 이번주 정복한 요일들 일요일(0) - 토요일(6)
          type: array
          items:
            $ref: '#/components/schemas/DayOfWeek'
      required:
        - todayConqueredCount
        - thisMonthConqueredCount
        - thisWeekConqueredWeekdays

    GetChallengeRequestDto:
      type: object
      properties:
        challengeId:
          type: string
      required:
        - challengeId

    GetChallengeResponseDto:
      type: object
      properties:
        challenge:
          $ref: '#/components/schemas/ChallengeDto'
        myRank:
          $ref: '#/components/schemas/ChallengeRankDto'
        ranks:
          type: array
          items:
            $ref: '#/components/schemas/ChallengeRankDto'
        contributionCountForNextRank:
          type: integer
          format: int64
          description: 다음 랭크에 도달하기 위해 필요한 contribution 수. ex) 10개 정복
        hasJoined:
          type: boolean
          description: 내가 참여하고 있는지에 대한 정보
        hasPasscode:
          type: boolean
          description: 참여코드를 입력해야만 참여할 수 있는 챌린지인지
      required:
        - challenge
        - ranks
        - hasJoined
        - hasPasscode

    GetChallengeWithInvitationCodeRequestDto:
      type: object
      properties:
        invitationCode:
          type: string
          description: 공개되어있지 않은, 초대코드로만 볼 수 있는 챌린지
      required:
        - invitationCode

    GetClientVersionStatusRequestDto:
      type: object
      properties:
        version:
          type: string
          description: 현재 클라이언트 버전 ex) 3.37.0
      required:
        - version

    GetClientVersionStatusResponseDto:
      type: object
      properties:
        status:
          type: string
          enum:
            - STABLE
            - UPGRADE_NEEDED
            - UPGRADE_RECOMMENDED
        message:
          type: string
          description: 강제 업데이트 혹은 업데이트 권장 사유
      required:
        - status

    GetUserInfoRequestDto:
      type: object
      properties: { }
      required: [ ]

    GetUserInfoResponseDto:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/User'
        flags:
          type: array
          items:
            type: string
          description: 유저의 플래그들. ex) [ "MAP_VISIBLE" ]
      required:
        - user

    GiveBuildingAccessibilityUpvoteRequestDto:
      type: object
      properties:
        buildingAccessibilityId:
          type: string
      required:
        - buildingAccessibilityId

    GivePlaceAccessibilityUpvoteRequestDto:
      type: object
      properties:
        placeAccessibilityId:
          type: string
      required:
        - placeAccessibilityId

    JoinChallengeRequestDto:
      type: object
      properties:
        challengeId:
          type: string
        passcode:
          type: string
          description: 참여코드를 입력해야만 참여가 가능한 챌린지에 한해서 필요
      required:
        - challengeId

    JoinChallengeResponseDto:
      type: object
      properties:
        challenge:
          $ref: '#/components/schemas/ChallengeDto'
        ranks:
          type: array
          description: 10위권까지의 랭킹 정보
          items:
            $ref: '#/components/schemas/ChallengeRankDto'
      required:
        - challenge
        - ranks

    KakaoTokensDto:
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
        idToken:
          type: string
      required:
        - accessToken
        - refreshToken
        - idToken

    ListChallengesItemDto:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        status:
          $ref: '#/components/schemas/ChallengeStatusDto'
        startsAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
        endsAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
        hasJoined:
          type: boolean
          description: 내가 참여중인지 여부
        createdAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
      required:
        - id
        - name
        - status
        - startsAt
        - hasJoined
        - createdAt

    ListChallengesRequestDto:
      type: object
      properties:
        statuses:
          type: array
          items:
            $ref: '#/components/schemas/ChallengeStatusDto'
        nextToken:
          type: string
        limit:
          type: integer
          format: int64
      required:
        - status

    ListChallengesResponseDto:
      description: filter 가 없으면 진행중인, 참여중인 챌린지를 우선적으로 보여준다.
      type: object
      properties:
        totalCount:
          type: integer
          format: int64
        nextToken:
          type: string
        items:
          type: array
          items:
            $ref: '#/components/schemas/ListChallengesItemDto'
      required:
        - totalCount
        - items

    ListConqueredPlacesRequestDto:
      type: object
      properties:
        nextToken:
          type: string
          description: 페이지 정보. 없으면 첫 페이지 요소들을 내려준다.
        limit:
          type: integer
          format: int64

    ListConqueredPlacesResponseDto:
      type: object
      properties:
        totalNumberOfItems:
          type: integer
          format: int64
          description: 정복한 장소의 전체 갯수
        nextToken:
          type: string
          description: 다음 페이지 정보. 없으면 더 이상 요청할 값이 없음을 의미한다.
        items:
          type: array
          items:
            $ref: '#/components/schemas/PlaceListItem'
      required:
        - totalNumberOfItems
        - items

    ListPlaceFavoritesByUserRequestDto:
      type: object
      properties:
        nextToken:
          type: string
          description: 페이지 정보. 없으면 첫 페이지 요소들을 내려준다.
        limit:
          type: integer
          format: int64

    ListPlaceFavoritesByUserResponseDto:
      type: object
      properties:
        totalNumberOfItems:
          description: 즐겨찾기한 장소의 전체 갯수
          type: integer
          format: int64
        nextToken:
          type: string
          description: 다음 페이지 정보. 없으면 더 이상 요청할 값이 없음을 의미한다.
        items:
          type: array
          items:
            $ref: '#/components/schemas/PlaceFavorite'
      required:
        - totalNumberOfItems
        - items

    Location:
      description: 위치를 위경도로 표현하기 위한 모델.
      type: object
      properties:
        lng:
          type: number
          format: double
        lat:
          type: number
          format: double
      required:
        - lng
        - lat

    LoginResultDto:
      type: object
      properties:
        authTokens:
          $ref: '#/components/schemas/AuthTokensDto'
        user:
          $ref: '#/components/schemas/User'
      required:
        - authTokens
        - user

    LoginWithAppleRequestDto:
      type: object
      properties:
        identityToken:
          type: string
        authorizationCode:
          type: string
      required:
        - identityToken
        - authorizationCode

    Place:
      description: 점포 정보.
      properties:
        id:
          type: string
        name:
          type: string
          description: 점포의 human-readable한 이름.
        address:
          type: string
          description: 점포의 human-readable한 주소.
        category:
          type: PlaceCategoryDto
          description: 점포의 카테고리
        isFavorite:
          type: boolean
          description: 내가 즐겨찾기한 점포인지 여부.
      required:
        - id
        - name
        - address

    PlaceAccessibility:
      description: 점포의 접근성 정보.
      properties:
        id:
          type: string
        placeId:
          type: string
        floors:
          type: array
          items:
            type: integer
        isFirstFloor:
          type: boolean
          deprecated: true
          description: '1층인지 여부. 240401 출시한 버전부터 이 필드는 사용하지 않고, floors 필드를 사용하도록 한다.'
        isStairOnlyOption:
          type: boolean
          description: '다른 층으로 가는 방법이 계단만 있는지 여부'
        imageUrls:
          deprecated: true
          type: array
          items:
            type: string
        images:
          type: array
          items:
            $ref: '#/components/schemas/ImageDto'
        stairInfo:
          $ref: '#/components/schemas/StairInfo'
        stairHeightLevel:
          $ref: '#/components/schemas/StairHeightLevel'
        hasSlope:
          type: boolean
        entranceDoorTypes:
          type: array
          items:
            $ref: '#/components/schemas/EntranceDoorType'
        registeredUserName:
          type: string
          description: 익명으로 등록되었으면 null.
        deletionInfo:
          type: object
          description: 삭제 가능하면 non-null, 삭제 불가능하면 null.
          properties:
            isLastInBuilding:
              type: boolean
              description: 장소가 포함된 건물 중 마지막으로 남은 장소 정보인지 여부.
          required:
            - isLastInBuilding
        challengeCrusherGroup:
          $ref: '#/components/schemas/ChallengeCrusherGroupDto'
        isUpvoted:
          type: boolean
          description: 유저가 이 접근성 정보에 '도움이 돼요'를 표시했는지 여부.
        createdAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
      required:
        - id
        - placeId
        - imageUrls
        - stairInfo
        - hasSlope
        - isFirstFloor
        - createdAt

    PlaceAccessibilityComment:
      description: 점포에 대한 의견.
      properties:
        id:
          type: string
        placeId:
          type: string
        user:
          $ref: '#/components/schemas/AccessibilityRegistererDto'
          description: 익명으로 달린 댓글이면 null.
        comment:
          type: string
        createdAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
      required:
        - id
        - placeId
        - comment
        - createdAt

    PlaceCategoryDto:
      type: string
      enum:
        - RESTAURANT
        - CAFE
        - ACCOMODATION
        - MARKET
        - CONVENIENCE_STORE
        - KINDERGARTEN
        - SCHOOL
        - ACADEMY
        - PARKING_LOT
        - GAS_STATION
        - SUBWAY_STATION
        - BANK
        - CULTURAL_FACILITIES
        - AGENCY
        - PUBLIC_OFFICE
        - ATTRACTION
        - HOSPITAL
        - PHARMACY

    ExternalAccessibility:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
          description: 장소의 human-readable한 이름.
        address:
          type: string
          description: 장소의 human-readable한 주소.
        location:
          $ref: '#/components/schemas/Location'
        category:
          type: string
          description: 장소의 종류
        toilet_details:
          $ref: '#/components/schemas/ToiletAccessibilityDetails'
      required:
        - id
        - name
        - location
        - category

    ToiletAccessibilityDetails:
      type: object
      properties:
        image_url:
          type: string
        gender:
          type: string
        accessDesc:
          type: string
        availableDesc:
          type: string
        entranceDesc:
          type: string
        stallWidth:
          type: string
        stallDepth:
          type: string
        doorDesc:
          type: string
        doorSideRoom:
          type: string
        washStandBelowRoom:
          type: string
        washStandHandle:
          type: string
        extraDesc:
          type: string

    PlaceListItem:
      type: object
      properties:
        place:
          $ref: '#/components/schemas/Place'
        building:
          $ref: '#/components/schemas/Building'
        hasBuildingAccessibility:
          type: boolean
        hasPlaceAccessibility:
          type: boolean
        distanceMeters:
          type: integer
          description: 요청에 currentLocation이 올라왔을 경우에만 non-null.
        isAccessibilityRegistrable:
          type: boolean
          description: 접근성 정보를 등록할 수 있는지 여부.
        accessibilityInfo:
          $ref: '#/components/schemas/CompactAccessibilityInfoDto'

      required:
        - place
        - building
        - hasBuildingAccessibility
        - hasPlaceAccessibility
        - isAccessibilityRegistrable

    CompactAccessibilityInfoDto:
      type: object
      properties:
        accessibilityScore:
          type: double
          description: 접근성 점수. 접근성 정보가 없는 경우 null
        imageUrls:
          type: array
          items:
            type: string
        images:
          type: array
          items:
            $ref: '#/components/schemas/ImageDto'
        hasSlope:
          type: boolean
        floors:
          type: array
          items:
            type: integer
        createdAt:
          $ref: '#/components/schemas/EpochMillisTimestamp'
      required:
        - images
        - imageUrls
        - hasSlope
        - floors

    RegisterBuildingAccessibilityRequestDto:
      type: object
      description: 각 건물에 대해 1번만 등록될 수 있다.
      properties:
        buildingId:
          type: string
        entranceStairInfo:
          $ref: '#/components/schemas/StairInfo'
        entranceStairHeightLevel:
          $ref: '#/components/schemas/StairHeightLevel'
        entranceImageUrls:
          type: array
          items:
            type: string
        entranceDoorTypes:
          type: array
          items:
            $ref: '#/components/schemas/EntranceDoorType'
        hasSlope:
          type: boolean
        hasElevator:
          type: boolean
        elevatorStairInfo:
          $ref: '#/components/schemas/StairInfo'
        elevatorStairHeightLevel:
          $ref: '#/components/schemas/StairHeightLevel'
        elevatorImageUrls:
          type: array
          items:
            type: string
        comment:
          type: string
      required:
        - buildingId
        - entranceStairInfo
        - entranceImageUrls
        - hasSlope
        - hasElevator
        - elevatorStairInfo
        - elevatorImageUrls

    RegisterPlaceAccessibilityRequestDto:
      type: object
      properties:
        placeId:
          type: string
        floors:
          type: array
          items:
            type: integer
        isStairOnlyOption:
          type: boolean
          description: '다른 층으로 가는 방법이 계단만 있는지 여부'
        isFirstFloor:
          type: boolean
          deprecated: true
          description: '1층인지 여부. 240401 출시한 버전부터 이 필드는 사용하지 않고, floors 필드를 사용하도록 한다.'
        imageUrls:
          type: array
          items:
            type: string
        stairInfo:
          $ref: '#/components/schemas/StairInfo'
        stairHeightLevel:
          $ref: '#/components/schemas/StairHeightLevel'
        hasSlope:
          type: boolean
        entranceDoorTypes:
          type: array
          items:
            $ref: '#/components/schemas/EntranceDoorType'
        comment:
          type: string
      required:
        - placeId
        - imageUrls
        - stairInfo
        - hasSlope

    RegisterPlaceAccessibilityResponseDto:
      type: object
      properties:
        accessibilityInfo:
          $ref: '#/components/schemas/AccessibilityInfoDto'
        registeredUserOrder:
          type: integer
          description: "'n번째 정복자'를 표시해주기 위한 값."
      required:
        - accessibilityInfo
        - registeredUserOrder

    SearchKeywordOfPlaceCategoryDto:
      type: object
      properties:
        category:
          $ref: '#/components/schemas/PlaceCategoryDto'
        keyword:
          type: string
          description: '검색창에 들어가는 문자열. ex) 음식점, 병원, 카페'
      required:
        - category
        - keyword

    SearchPlaceSortDto:
      type: string
      enum:
        - ACCURACY
        - DISTANCE
        - ACCESSIBILITY_SCORE

    SearchPlaceFilterDto:
      type: object
      properties:
        maxAccessibilityScore:
          type: double
          description: 접근성 점수의 최대값. 이 값 이하의 점수를 가진 장소만 반환한다. null이면 필터링하지 않는다.
        hasSlope:
          type: boolean
          description: 경사로가 있는/없는 장소만 반환한다. null이면 필터링하지 않는다.
        isRegistered:
          type: boolean
          description: 접근성 정보가 등록된/등록되지 않은 장소만 반환한다. null이면 필터링하지 않는다.

    SiGunGu:
      description: 시군구를 표현하기 위한 모델.
      type: object
      properties:
        id:
          type: string
        name:
          type: string
      required:
        - id
        - name

    StairHeightLevel:
      type: string
      enum:
        - HALF_THUMB
        - THUMB
        - OVER_THUMB

    StairInfo:
      type: string
      enum:
        - UNDEFINED # e.g. 엘리베이터가 아예 없는 경우, 엘리베이터 계단 정보는 UNDEFINED로 올린다.
        - NONE
        - ONE
        - TWO_TO_FIVE
        - OVER_SIX

    User:
      description: 유저 정보.
      properties:
        id:
          type: string
        nickname:
          type: string
        instagramId:
          type: string
        email:
          type: string
        birthYear:
          type: integer
        mobilityTools:
          type: array
          items:
            $ref: '#/components/schemas/UserMobilityToolDto'
        isNewsLetterSubscriptionAgreed:
          type: boolean
          description: 뉴스레터 수신 동의 여부
          nullable: true
      required:
        - id
        - nickname
        - mobilityTools
        - isNewsLetterSubscriptionAgreed

    UserMobilityToolDto:
      type: string
      enum:
        - MANUAL_WHEELCHAIR # 수동휠체어
        - ELECTRIC_WHEELCHAIR # 전동휠체어
        - MANUAL_AND_ELECTRIC_WHEELCHAIR # 수전동휠체어
        - STROLLER # 유아차 이용자
        - PROSTHETIC_FOOT # 의족
        - WALKING_ASSISTANCE_DEVICE # 보행보조기구
        - CLUCH # 클러치(목발, 지팡이)
        - NONE # 해당사항없음
        - FRIEND_OF_TOOL_USER # 도구를 사용하는 사람의 친구

    ImageDto:
      type: object
      properties:
        imageUrl:
          type: string
        imageWidth:
          type: integer
          format: int32
          description: '원본 이미지의 width'
        imageHeight:
          type: integer
          format: int32
          description: '원본 이미지의 height'
        thumbnailUrl:
          type: string
          description: '아직 썸네일이 생성되지 않았다면 null'
      required:
        - imageUrl

    DayOfWeek:
      type: string
      enum:
        - SUNDAY
        - MONDAY
        - TUESDAY
        - WEDNESDAY
        - THURSDAY
        - FRIDAY
        - SATURDAY

    GetHomeBannersResponseDto:
      type: object
      properties:
        banners:
          type: array
          items:
            $ref: '#/components/schemas/HomeBannerDto'
      required:
        - banners

    HomeBannerDto:
      type: object
      properties:
        id:
          type: string
        loggingKey:
          type: string
        imageUrl:
          type: string
        clickPageUrl:
          type: string
        clickPageTitle:
          type: string
      required:
        - id
        - loggingKey
        - imageUrl
        - clickPageUrl
        - clickPageTitle

  responses:
    ApiFailure:
      description: failed to get response
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ApiErrorResponse'
